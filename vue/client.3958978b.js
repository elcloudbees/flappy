webpackJsonp([0,2],[function(t,e,i){"use strict";function s(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){for(var e=t.width,i=t.height,s=t.remainder,n=t.blocks,r=t.distance,o=void 0===r?10:r,c=t.isRandom,u=void 0!==c&&c,l=[],f=n.length,d=e,_=0;s>0;){var v=void 0;u?v=n[(0,h.random)(0,f-1)]:(v=n[_%f],_++);var p=v.width+a(o);v=v.clone(),v._setStartX(d),s-=p,d+=p,v._setCanvas(e,i),l.push(v)}return l}function a(t){return Array.isArray(t)?h.random.apply(void 0,s(t)):t}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}();e.genBlocks=r;var h=i(11),c=0,u=function(){function t(e){var i=e.width,s=void 0===i?30:i,r=e.height,o=void 0===r?30:r,u=e.padding,l=void 0===u?0:u,f=e.placement,d=void 0===f?"random":f,_=e.name,v=void 0===_?"Block":_,p=e.data;n(this,t),this.startX=0,this._width=s,this._height=o,this._padding=l,this.width=a(s),this.height=a(o),this.padding=a(l),this.placement=d,this._direction="random"===d?(0,h.random)(0,1):Number("bottom"===d),this.uid=c++,this.name=v,this._canvasHeight=0,this._canvasWidth=0,this.data=p}return o(t,[{key:"_setStartX",value:function(t){this.startX=t}},{key:"_setCanvas",value:function(t,e){this._canvasWidth=t,this._canvasHeight=e}},{key:"clone",value:function(){return new t({width:this._width,height:this._height,padding:this._padding,placement:this.placement,name:this.name})}},{key:"moveX",value:function(t){this.startX-=t}},{key:"moveY",value:function(t){this.startY+=t}},{key:"endX",get:function(){return this.startX+this.width}},{key:"endY",get:function(){return this.startY+this.height}},{key:"startY",get:function(){var t=this._direction,e=t?-this.padding:this.padding;return(this._canvasHeight-this.height)*t+e}}]),t}();e.default=u},function(t,e,i){"use strict";function s(t){return function(e){if(!t[e])throw Error("[Flappy:"+this.name+"] Unknown state:",e);this._state=this.__state=t[e]}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var i=e.state,n=e.handler;t._action=s(i),Object.defineProperty(t,"_state",{get:function(){return this.__state},set:n})}},,,function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}var n=i(31),r=s(n),a=i(26),o=s(a),h=i(13),c=s(h),u=/mobile/i.test(navigator.userAgent),l={height:384,width:288,floorHeight:55,fps:50},f=new h.Player({height:26,width:36,startX:50,velocity:10,pop:10,reverse:!0}),d=new h.Block({name:"tube",width:52,padding:100,height:[100,150]}),_=new c.default({canvas:l,player:f,levels:[{score:0,blocks:[d],blockDistance:[50,80]}]});!u&&document.addEventListener("keydown",function(t){if(32===t.keyCode||38===t.keyCode||87===t.keyCode){if("READY"===_.state)_.start();else if("OVER"===_.state)return void _.restart();f.jump()}}),new r.default({el:"#app",render:function(t){return t(o.default,{props:{player:f,flappy:_,isMobile:u}})}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"bird",props:{image:{},ctx:{},data:Object},created:function(){this.count=0},render:function(){},watch:{data:{deep:!0,handler:function(){var t=this.data,e=t.startX,i=t.startY,s=t.width,n=t.height,r=t.offset,a=parseInt(++this.count/10,10)%3*s,o=2*r*Math.PI/180,h=Math.cos(o),c=Math.sin(o),u=h*e-c*i,l=h*i+c*e-s/2;this.ctx.save(),this.ctx.rotate(-o),this.ctx.drawImage(this.image,a,0,s,n,u,l,s,n),this.ctx.restore()}}}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"tube",props:{image:{},ctx:{},data:Object},render:function(){},watch:{data:{deep:!0,handler:function(){var t=this.data,e=t.startX,i=t.startY,s=t.width,n=t.endY;this.ctx.save(),this.ctx.drawImage(this.image,0,0,s,n,e,n,s,n),this.ctx.scale(1,-1),this.ctx.drawImage(this.image,0,0,s,i,e,-i,s,i),this.ctx.restore()}}}}},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),r=s(n),a=i(6),o=s(a),h=i(27),c=s(h),u=i(24),l=s(u),f=(0,l.default)([i(19),i(20),i(22),i(21)]);e.default={components:{FCanvas:c.default,FBird:r.default,FTube:o.default},props:["flappy","player","isMobile"],data:function(){return{score:0,lastScore:0,gameState:"",bird:{},tubes:[],images:[]}},computed:{highScore:function(){return this.lastScore>this.score?this.lastScore:this.score}},methods:{jump:function(){if("READY"===this.flappy.state)this.flappy.start();else if("OVER"===this.flappy.state)return void this.flappy.restart();this.player.jump()}},mounted:function(){var t=this;f.then(function(e){var i=t.$refs.canvas;t.images=e,t.$nextTick(function(t){return i.reset()}),t.flappy.on(["game:progress","game:ready"],function(e){i.reset(e.score),t.score=e.score,t.bird=e.player,t.tubes=e.blocks,t.gameState=e.state}),t.flappy.on(["player:hitblock","player:hitfloor"],function(e){t.flappy.gameover(),t.lastScore=t.score})})}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"canvas",props:{width:Number,height:Number,floorHeight:Number,score:Number,groundImage:{},bgImage:{},isMobile:Boolean},data:function(){return{ctx:{},clientWidth:this.width}},created:function(){this.count=0,this.groundY=this.height-this.floorHeight,this.isMobile&&(this.clientWidth="100vw")},methods:{reset:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=3*++this.count%48;this.ctx.clearRect(0,0,this.width,this.height),this.ctx.drawImage(this.bgImage,0,0),this.ctx.drawImage(this.groundImage,e,0,this.width,this.floorHeight,0,this.groundY,this.width,this.floorHeight),this.drawScore(t)},drawScore:function(t){this.ctx.font="bold 14px verdana, sans-serif",this.ctx.fillStyle="#fff",this.ctx.fillText(t,10,20)}},mounted:function(){this.ctx=this.$refs.canvas.getContext("2d")}}},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(14),o=s(a),h=i(1),c=s(h),u=i(0),l={OVER:"OVER",PROGRESS:"PROGRESS",PAUSE:"PAUSE",READY:"READY"},f=function(){function t(e){var i=e.width,s=void 0===i?300:i,r=e.height,a=void 0===r?600:r,o=e.floorHeight,h=void 0===o?0:o,c=e.fps,u=void 0===c?30:c;n(this,t),this.width=s,this.height=a,this.floorHeight=h,this.fps=u}return r(t,[{key:"frames",get:function(){return 1e3/this.fps}}]),t}(),d=function(){function t(e){var i=e.canvas,s=void 0===i?{}:i,r=e.levels,a=void 0===r?[]:r,o=e.player;n(this,t),this._canvas=new f(s),this._levels=[].concat(a),this._score=0,this._player=o,this._init()}return r(t,[{key:"_stateHandler",value:function(t){switch(t){case l.READY:this._player._refresh(),this.emit("game:ready",this._stats);break;case l.PROGRESS:this._refresh(),this.emit("game:progress",this._stats);break;case l.OVER:this.emit("game:over",this._stats);break;case l.PAUSE:}}},{key:"_init",value:function(){var t=this;if(!Array.isArray(this._levels)||!this._levels.length)throw Error("[Flappy] levels is required.");this._levels.forEach(function(t,e){var i=t.blocks;if(!Array.isArray(i)||!i.length)throw Error("[Flappy] levels["+e+"].blocks is required.")}),(0,o.default)(this),(0,c.default)(this,{state:l,handler:this._stateHandler}),this._player._init(this),this.on("_hitfloor",this._onHitFloor),setTimeout(function(e){return t._action(l.READY)},0)}},{key:"_run",value:function(){var t=this;this._action(l.PROGRESS),setTimeout(function(e){t._state===l.PROGRESS&&t._run()},this._canvas.frames)}},{key:"_refresh",value:function(){var t=this;this._player._refresh(),this._blocks.forEach(function(e){return e.moveX(t._level.speed||5)}),this._checkHit()}},{key:"_checkHit",value:function(){for(var t=this._player,e=0,i=this._blocks.length;e<i;e++){var s=this._blocks[e];if(!(s.startX>t.endX-t.pop||s.endX<t.startX+t.pop)){if(t.reverse?s.startY>t.endY-t.height-t.pop||s.endY<t.startY+t.pop:!(s.startY>t.endY-t.pop||s.endY<t.startY-t.height+t.pop))this.emit("player:hitblock",{block:s,stats:this._stats});else{if(s._disabled)continue;this._score++}s._disabled=!0;break}}}},{key:"_onHitFloor",value:function(){this.emit("player:hitfloor",{stats:this._stats})}},{key:"start",value:function(){this._run(),this.emit("game:start",this._stats)}},{key:"restart",value:function(t){this._player._reset(),this._player.startY=this._player.startY||this._canvas.height/2,this._score=0,this._blocks=[],t?(this.start(),this._player.jump()):this._action(l.READY)}},{key:"pause",value:function(){this._action(l.PAUSE)}},{key:"continue",value:function(){this._action(l.PROGRESS)}},{key:"gameover",value:function(){this._action(l.OVER)}},{key:"state",get:function(){return this._state}},{key:"_score",set:function(t){var e=this;if(this.__score===t)return t;this._level=this._levels.find(function(t){return t.score<=e._score})||this._levels[0],this.__score=t},get:function(){return this.__score}},{key:"_blocks",get:function(){this.__blocks=this.__blocks||[];var t=this.__blocks[0];if(t){if(t.endX>=0)return this.__blocks;this.__blocks.shift()}var e=this._level,i=e.blocks,s=e.blockDistance,n=e.blockRandom,r=this.__blocks.length-1,a=0;r>0&&(a=this.__blocks[r].endX);var o=this._canvas.width-a;return this.__blocks=this.__blocks.concat((0,u.genBlocks)({width:this._canvas.width,height:this._canvas.height,remainder:o,blocks:i,distance:s,isRandom:n})),this.__blocks},set:function(t){this.__blocks=t}},{key:"_stats",get:function(){return{player:this._player,blocks:this._blocks,canvas:this._canvas,score:this._score,level:this._level,state:this._state}}}],[{key:"name",get:function(){return"Flappy"}}]),t}();e.default=d},function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),r=function(){function t(e){var i=e.velocity,n=void 0===i?15:i,r=e.fps,a=void 0===r?30:r,o=e.g,h=void 0===o?20:o;s(this,t),this._time=0,this._v=n,this.last=0,this.G=h/a}return n(t,[{key:"reset",value:function(){this._time=0,this.last=0}},{key:"decelerate",value:function(){this._time++;var t=this._time*(this._v-this.G*this._time),e=t-this.last;return this.last=t,e}}]),t}();e.default=r},function(t,e,i){"use strict";function s(t,e){return Math.floor(t+Math.random()*(e-t+1))}Object.defineProperty(e,"__esModule",{value:!0}),e.random=s},function(t,e,i){"use strict";function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var i in e)t[i]=e[i];return t}Object.defineProperty(e,"__esModule",{value:!0}),e.extend=s},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=i(0);Object.defineProperty(e,"Block",{enumerable:!0,get:function(){return s(n).default}});var r=i(15);Object.defineProperty(e,"Player",{enumerable:!0,get:function(){return s(r).default}});var a=i(9);Object.defineProperty(e,"default",{enumerable:!0,get:function(){return s(a).default}})},function(t,e,i){"use strict";function s(t,e){this._listener[t]=this._listener[t]||[],this._listener[t].push(e)}function n(t,e){var i=this;Array.isArray(t)?t.forEach(function(t){i._addListener(t,e)}):this._addListener(t,e)}function r(t){for(var e=this,i=arguments.length,s=Array(i>1?i-1:0),n=1;n<i;n++)s[n-1]=arguments[n];this._listener[t]&&this._listener[t].forEach(function(t){return t&&t.apply(e,s)})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){t._listener={},t.on=n,t.emit=r,t._addListener=s}},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(10),o=s(a),h=i(1),c=s(h),u=i(12),l={JUMPING:"JUMPING",WAITING:"WAITING"},f=0,d=function(){function t(e){n(this,t),this._options=(0,u.extend)({height:30,width:30,startX:0,startY:0,velocity:15,g:20,name:"Player",pop:0,reverse:!1},e),this._reset()}return r(t,[{key:"_reset",value:function(){var t=this._options,e=t.startX,i=t.startY,s=t.width,n=t.height,r=t.velocity,a=t.g,o=t.name,h=t.data,c=t.pop,u=t.reverse;this.startX=e,this.startY=i,this.width=s,this.height=n,this.velocity=r,this.g=a,this.uid=f++,this.name=o,this.data=h,this.pop=c,this.reverse=u,this.offset=0}},{key:"_stateHandler",value:function(t){switch(t){case l.JUMPING:this._moveUp();break;case l.WAITING:}}},{key:"_init",value:function(t){(0,c.default)(this,{state:l,handler:this._stateHandler});var e=t._canvas;this._parent=t,this._linearMotion=new o.default({velocity:this.velocity,fps:e.fps,g:this.g}),this.startY=this.startY||e.height/2,this._action(l.WAITING)}},{key:"_moveUp",value:function(){this.offset=this._linearMotion.decelerate();var t=this._parent._canvas.height-this._parent._canvas.floorHeight+this.pop;this.startY-=this.offset,this.endY>t&&(this.startY=t-this.height,this._action(l.WAITING),this._parent.emit("_hitfloor"))}},{key:"_refresh",value:function(){this._action(this._state||l.WAITING)}},{key:"jump",value:function(){this._linearMotion.reset(),this._action(l.JUMPING)}},{key:"endX",get:function(){return this.startX+this.width}},{key:"endY",get:function(){return this.startY+this.height}},{key:"state",get:function(){return this._state}}]),t}();e.default=d},,,function(t,e){},function(t,e,i){t.exports=i.p+"static/bg.f3651b8b.png"},function(t,e,i){t.exports=i.p+"static/bird.89827bdb.png"},function(t,e,i){t.exports=i.p+"static/ground.c0df5efd.png"},function(t,e,i){t.exports=i.p+"static/tube.67df21f3.png"},,,,function(t,e,i){i(18);var s=i(2)(i(7),i(29),null,null);t.exports=s.exports},function(t,e,i){var s=i(2)(i(8),i(28),null,null);t.exports=s.exports},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("canvas",t._b({ref:"canvas",staticClass:"canvas",style:{width:t.clientWidth}},"canvas",t.$props),[t._t("default",null,{ctx:t.ctx})],2)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("main",{staticClass:"app",class:{mobile:t.isMobile}},[i("h1",[t._v("Vue.js Flappy Bird")]),t._v(" "),i("p",[t._v("\n    High Score: "+t._s(t.highScore)+"\n    "),"OVER"===t.gameState?i("a",{on:{click:function(e){t.flappy.restart()}}},[t._v("Restart")]):t._e()]),t._v(" "),i("f-canvas",t._b({ref:"canvas",attrs:{"bg-image":t.images[0],"ground-image":t.images[3],score:t.score,"is-mobile":t.isMobile},nativeOn:{touchstart:function(e){t.jump(e)}},scopedSlots:t._u([["default",function(e){return[i("f-bird",{attrs:{image:t.images[1],ctx:e.ctx,data:t.bird}}),t._v(" "),t._l(t.tubes,function(s){return i("f-tube",{key:s.id,attrs:{image:t.images[2],ctx:e.ctx,data:s}})})]}]])},"f-canvas",t.flappy._canvas)),t._v(" "),t._m(0)],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("p",[t._v("Powered by\n    "),i("a",{attrs:{href:"https://github.com/wasd-org/wasd-flappy"}},[t._v("wasd-flappy")])])}]}},,,function(t,e,i){t.exports=i(4)}],[32]);