webpackJsonp([0,2],[,function(t,e,i){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){for(var e=t.width,i=t.height,n=t.remainder,s=t.blocks,r=t.distance,o=void 0===r?10:r,u=t.isRandom,h=void 0!==u&&u,l=[],f=s.length,d=e,_=0;n>0;){var v=void 0;h?v=s[(0,c.random)(0,f-1)]:(v=s[_%f],_++);var p=v.width+a(o);v=v.clone(),v._setStartX(d),n-=p,d+=p,v._setCanvas(e,i),l.push(v)}return l}function a(t){return Array.isArray(t)?c.random.apply(void 0,n(t)):t}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.genBlocks=r;var c=i(11),u=0,h=function(){function t(e){var i=e.width,n=void 0===i?30:i,r=e.height,a=void 0===r?30:r,o=e.padding,h=void 0===o?10:o,l=e.placement,f=void 0===l?"random":l,d=e.name,_=void 0===d?"Block":d,v=e.data;s(this,t),this.startX=0,this.width=n,this.height=a,this.placement=f,this._direction="random"===f?(0,c.random)(0,1):Number("top"===f),this._padding=h,this.uid=u++,this.name=_,this._canvasHeight=0,this._canvasWidth=0,this.data=v}return o(t,[{key:"_setStartX",value:function(t){this.startX=t}},{key:"_setCanvas",value:function(t,e){this._canvasWidth=t,this._canvasHeight=e}},{key:"clone",value:function(){return new t({width:this.width,height:this.height,placement:this.placement,name:this.name,padding:this._padding})}},{key:"moveX",value:function(t){this.startX-=t}},{key:"moveY",value:function(t){this.startY+=t}},{key:"endX",get:function(){return this.startX+this.width}},{key:"endY",get:function(){return this.startY+this.height}},{key:"startY",get:function(){var t=this._direction,e=t?-this._padding:this._padding;return(this._canvasHeight-this.height)*t+e}}]),t}();e.default=h},function(t,e,i){"use strict";function n(t){return function(e){if(!t[e])throw Error("[Flappy:"+this.name+"] Unknown state:",e);this._state=this.__state=t[e]}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var i=e.state,s=e.handler;t._action=n(i),Object.defineProperty(t,"_state",{get:function(){return this.__state},set:s})}},,function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(33),r=n(s),a=i(24),o=n(a),c=i(12),u=n(c),h=/mobile/i.test(navigator.userAgent),l={height:h?window.screen.height:600,width:h?window.screen.width:400,fps:50},f=new c.Player({height:26,width:35}),d=new u.default({canvas:l,player:f,levels:[{score:0,blocks:[new c.Block({name:"tube",placement:"random"})]}]});document.addEventListener("keydown",function(t){32!==t.keyCode&&38!==t.keyCode&&87!==t.keyCode||("READY"===d.state&&d.start(),f.jump())}),new r.default({el:"#app",render:function(t){return t(o.default,{props:{player:f,flappy:d,isMobile:h}})}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=i(25),r=n(s),a=i(27),o=n(a),c=i(26),u=n(c);e.default={components:{FCanvas:u.default,FBird:r.default,FTube:o.default},props:["flappy","player","isMobile"],data:function(){return{score:0,gameState:"",birdState:"",bird:{}}},mounted:function(){var t=this,e=this.$refs.canvas;this.flappy.on(["game:progress","game:ready"],function(i){e.clear(),t.bird=i.player,t.score=i.score,t.gameState=i.state}),this.flappy.on(["game:hitblock","game:hitfloor"],function(e){console.log("done"),t.flappy.pause()}),this.flappy.on("game:start",function(e){t.birdState="MOTION",t.gameState="PROGRESS"})}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={QUIET:"QUIET",DEATH:"DEATH",MOTION:"MOTION"};e.default={name:"bird",props:{data:Object,ctx:{},state:{type:String,default:n.QUIET}},created:function(){this.count=0},methods:{drawBird:function(){var t=this;this.$watch("data",function(e){var i=t.data,n=i.startX,s=i.startY,r=i.width,a=i.height,o=i.offset,c=parseInt(t.count++/10,10)%3*36,u=o*Math.PI/180,h=Math.cos(u),l=Math.sin(u),f=h*n-l*s,d=h*s+l*n;t.ctx.save(),t.ctx.rotate(-u),t.ctx.drawImage(t.$refs.image,c,0,36,a,f,d,r,a),t.ctx.restore()},{deep:!0,immediate:!0})}},watch:{state:function(t){}}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"canvas",props:["width","height"],data:function(){return{ctx:{}}},methods:{clear:function(){this.ctx.clearRect(0,0,this.width,this.height)}},mounted:function(){this.ctx=this.$refs.canvas.getContext("2d")}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"tube",data:function(){return{}}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(13),o=n(a),c=i(2),u=n(c),h=i(1),l={OVER:"OVER",PROGRESS:"PROGRESS",PAUSE:"PAUSE",READY:"READY"},f=function(){function t(e){var i=e.width,n=void 0===i?300:i,r=e.height,a=void 0===r?600:r,o=e.fps,c=void 0===o?30:o;s(this,t),this.width=n,this.height=a,this.fps=c}return r(t,[{key:"frames",get:function(){return 1e3/this.fps}}]),t}(),d=function(){function t(e){var i=e.canvas,n=void 0===i?{}:i,r=e.levels,a=void 0===r?[]:r,o=e.player;s(this,t),this._canvas=new f(n),this._levels=[].concat(a),this._score=0,this._player=o,this._init()}return r(t,[{key:"_stateHandler",value:function(t){switch(t){case l.READY:this._player._refresh(),this.emit("game:ready",this._stats);break;case l.PROGRESS:this._refresh(),this.emit("game:progress",this._stats);break;case l.OVER:this.emit("game:over",this._stats);break;case l.PAUSE:}}},{key:"_init",value:function(){var t=this;if(!Array.isArray(this._levels)||!this._levels.length)throw Error("[Flappy] levels is required.");this._levels.forEach(function(t,e){var i=t.blocks;if(!Array.isArray(i)||!i.length)throw Error("[Flappy] levels["+e+"].blocks is required.")}),(0,o.default)(this),(0,u.default)(this,{state:l,handler:this._stateHandler}),this._player._init(this),this.on("_hitfloor",this._onHitFloor),setTimeout(function(e){return t._action(l.READY)},0)}},{key:"_run",value:function(){var t=this;this._action(l.PROGRESS),setTimeout(function(e){t._state===l.PROGRESS&&t._run()},this._canvas.frames)}},{key:"_refresh",value:function(){var t=this;this._player._refresh(),this._blocks.forEach(function(e){return e.moveX(t._level.speed||5)}),this._checkHit()}},{key:"_checkHit",value:function(){for(var t=this._player,e=0,i=this._blocks.length;e<i;e++){var n=this._blocks[e];if(!(n.startX>t.endX||n.endX<t.startX)){if(n._disabled)continue;n.startY>t.endY||n.endY<t.startY?this._score++:this.emit("player:hitblock",{block:n,stats:this._stats}),n._disabled=!0;break}}}},{key:"_onHitFloor",value:function(){this.emit("player:hitfloor")}},{key:"start",value:function(){this._run(),this.emit("game:start",this._stats)}},{key:"pause",value:function(){this._action(l.PAUSE)}},{key:"continue",value:function(){this._action(l.PROGRESS)}},{key:"gameover",value:function(){this._action(l.OVER)}},{key:"state",get:function(){return this._state}},{key:"_score",set:function(t){var e=this;if(this.__score===t)return t;this._level=this._levels.find(function(t){return t.score<=e._score})||this._levels[0],this.__score=t},get:function(){return this.__score}},{key:"_blocks",get:function(){this.__blocks=this.__blocks||[];var t=this.__blocks[0];if(t){if(t.endX>=0)return this.__blocks;this.__blocks.shift()}var e=this._level,i=e.blocks,n=e.blockDistance,s=e.blockRandom,r=this.__blocks.reduce(function(t,e){return t+e.width},0),a=this._canvas.width-r;return this.__blocks=this.__blocks.concat((0,h.genBlocks)({width:this._canvas.width,height:this._canvas.height,remainder:a,blocks:i,distance:n,isRandom:s})),this.__blocks}},{key:"_stats",get:function(){return{player:this._player,blocks:this._blocks,canvas:this._canvas,score:this._score,level:this._level}}}],[{key:"name",get:function(){return"Flappy"}}]),t}();e.default=d},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e){var i=e.velocity,s=void 0===i?15:i,r=e.fps,a=void 0===r?30:r,o=e.g,c=void 0===o?20:o;n(this,t),this._time=0,this._v=s,this.last=0,this.G=c/a}return s(t,[{key:"reset",value:function(){this._time=0,this.last=0}},{key:"decelerate",value:function(){this._time++;var t=this._time*(this._v-this.G*this._time),e=t-this.last;return this.last=t,e}}]),t}();e.default=r},function(t,e,i){"use strict";function n(t,e){return Math.floor(t+Math.random()*(e-t+1))}Object.defineProperty(e,"__esModule",{value:!0}),e.random=n},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=i(1);Object.defineProperty(e,"Block",{enumerable:!0,get:function(){return n(s).default}});var r=i(14);Object.defineProperty(e,"Player",{enumerable:!0,get:function(){return n(r).default}});var a=i(9);Object.defineProperty(e,"default",{enumerable:!0,get:function(){return n(a).default}})},function(t,e,i){"use strict";function n(t,e){this._listener[t]=this._listener[t]||[],this._listener[t].push(e)}function s(t,e){var i=this;Array.isArray(t)?t.forEach(function(t){i._addListener(t,e)}):this._addListener(t,e)}function r(t){for(var e=this,i=arguments.length,n=Array(i>1?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];this._listener[t]&&this._listener[t].forEach(function(t){return t&&t.apply(e,n)})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){t._listener={},t.on=s,t.emit=r,t._addListener=n}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(10),o=n(a),c=i(2),u=n(c),h={JUMPING:"JUMPING",WAITING:"WAITING"},l=0,f=function(){function t(e){var i=e.height,n=void 0===i?30:i,r=e.width,a=void 0===r?30:r,o=e.startX,c=void 0===o?0:o,u=e.startY,h=void 0===u?0:u,f=e.velocity,d=void 0===f?15:f,_=e.g,v=void 0===_?20:_,p=e.name,y=void 0===p?"Player":p,b=e.data;s(this,t),this.startX=c,this.startY=h,this.width=a,this.height=n,this.velocity=d,this.g=v,this.uid=l++,this.name=y,this.data=b}return r(t,[{key:"_stateHandler",value:function(t){switch(t){case h.JUMPING:this._moveUp();break;case h.WAITING:}}},{key:"_init",value:function(t){(0,u.default)(this,{state:h,handler:this._stateHandler});var e=t._canvas;this._parent=t,this._linearMotion=new o.default({velocity:this.velocity,fps:e.fps,g:this.g}),this.startY=this.startY||e.height/2,this._action(h.WAITING)}},{key:"_moveUp",value:function(){this.offset=this._linearMotion.decelerate();var t=this._parent._canvas.height;this.startY-=this.offset,this.endY>t&&(this.startY=t-this.height,this._action(h.WAITING),this._parent.emit("_hitfloor"))}},{key:"_refresh",value:function(){this._action(this._state||h.WAITING)}},{key:"jump",value:function(){this._linearMotion.reset(),this._action(h.JUMPING)}},{key:"endX",get:function(){return this.startX+this.width}},{key:"endY",get:function(){return this.startY+this.height}},{key:"state",get:function(){return this._state}}]),t}();e.default=f},,,function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e,i){t.exports=i.p+"static/bird.89827bdb.png"},,,function(t,e,i){i(20);var n=i(0)(i(5),i(31),null,null);t.exports=n.exports},function(t,e,i){i(19);var n=i(0)(i(6),i(30),"data-v-74c2adb6",null);t.exports=n.exports},function(t,e,i){i(17);var n=i(0)(i(7),i(28),"data-v-105c7195",null);t.exports=n.exports},function(t,e,i){i(18);var n=i(0)(i(8),i(29),"data-v-22232a01",null);t.exports=n.exports},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("canvas",t._b({ref:"canvas",staticClass:"canvas"},"canvas",t.$props),[t._t("default",null,{ctx:t.ctx})],2)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"tube"})},staticRenderFns:[]}},function(t,e,i){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bird"},[n("img",{ref:"image",attrs:{src:i(21)},on:{load:t.drawBird}})])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("main",{staticClass:"app",class:{mobile:t.isMobile}},[t.isMobile?t._e():i("h1",[t._v("Flappy Bird for Vue.js")]),t._v(" "),i("f-canvas",t._b({ref:"canvas",scopedSlots:t._u([["default",function(e){return[i("f-bird",{attrs:{state:t.birdState,ctx:e.ctx,data:t.bird}})]}]])},"f-canvas",t.flappy._canvas)),t._v(" "),t.isMobile?t._e():i("p",[t._v("Powered by\n    "),i("a",{attrs:{href:"https://github.com/wasd-org/wasd-flappy"}},[t._v("wasd-flappy")])])],1)},staticRenderFns:[]}},,,function(t,e,i){t.exports=i(4)}],[34]);